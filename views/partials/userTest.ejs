<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.8.0/Chart.bundle.js"></script>
<div class="user-heading">
  <div class="user-info">
    <h1><%=result[0].user_Name%></h1>
    <h3><%=result[0].email%></h3>
  </div>
  <div class="user-chart">
    <h5>Tests Completed %</h5>
    <canvas id="test-chart">Your browser does not support the canvas feature.</canvas>
  </div>
</div>
<div class="test-table">
  <div class="dash-item">
    <table class="table">
        <thead>
          <tr>
            <th scope="col">Test</th>
            <th scope="col">Result</th>
            <th scope="col">Completed</th>
          </tr>
        </thead>
        <tbody>
        <% for(let i = 0; i < result.length; i++){%>
          <tr>
            <th scope="row"><%=result[i].name%></th>
            <td><%=result[i].correct%>/<%=result[i].total%></td>
            <td style="width: 20%;"><div class="status-complete">Completed</div></td>
          </tr>
          <% } %>
        </tbody>
      </table>
  </div>
  </div>
</div>


<script type="text/javascript">

  var canvas = document.getElementById("test-chart");
  var ctx = canvas.getContext("2d");
  var result = <%- JSON.stringify(result); %>;
  var labels = result.map(test => { return test.name });
  var correct = result.map(test => {return ((test.correct / test.total) * 100)});
  console.log(Object.values(correct))
  console.log(result[0].correct)

  var myChart = new Chart(ctx, {
      type: 'radar',
      data: {
          labels: labels,
          datasets: [{
              label: 'Correct Answers',
              data: Object.values(correct),
              backgroundColor: "rgb(15, 56, 191, 0.5)"
          }]
      },
      options: {
        responsive: false,
        maintainAspectRatio: true,
        scale: {
          ticks: {
            beginAtZero: true,
            min: 0,
            max: 100,
            stepSize: 50
          },
          pointLabels: {
            fontSize: 15
          }
        },
        legend: {
          position: 'center'
        }

      }
  });
</script>